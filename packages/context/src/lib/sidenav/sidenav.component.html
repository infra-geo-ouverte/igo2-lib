<mat-sidenav #sidenav igoSidenavShim mode="side" [opened]="opened">
  <div class="igo-sidenav-content">
    <igo-flexible
      #topPanel
      initial="50%"
      initialMobile="100%"
      expanded="calc(100% - 58px)"
      [state]="topPanelState"
    >
      <div class="igo-content">
        <igo-panel [title]="tool ? (tool.title | translate) : title">
          @if (tool) {
            <button
              mat-icon-button
              panelLeftButton
              tooltip-position="below"
              matTooltipShowDelay="500"
              [matTooltip]="'igo.context.sidenav.goBack' | translate"
            >
              <mat-icon>arrow_back</mat-icon>
            </button>
          }

          @if (tool) {
            <button
              mat-icon-button
              panelRightButton
              tooltip-position="below"
              matTooltipShowDelay="500"
              [matTooltip]="'igo.context.sidenav.mainMenu' | translate"
            >
              <mat-icon>menu</mat-icon>
            </button>
          }
        </igo-panel>
      </div>

      <div igoFlexibleFill class="igo-content">
        @if (feature && media !== 'mobile') {
          <igo-panel [title]="featureTitle">
            <button
              mat-icon-button
              panelLeftButton
              class="igo-icon-button"
              (click)="toggleTopPanel()"
            >
              <mat-icon>{{
                ['collapsed', 'initial'].indexOf(topPanel.state) >= 0
                  ? 'arrow_downward'
                  : 'arrow_upward'
              }}</mat-icon>
            </button>
            @if (feature.geometry) {
              <button
                mat-icon-button
                panelRightButton
                class="igo-icon-button"
                (click)="zoomToFeatureExtent()"
              >
                <mat-icon>zoom_in</mat-icon>
              </button>
            }
            @if (['collapsed', 'initial'].indexOf(topPanel.state) >= 0) {
              <igo-feature-details [feature]="feature" />
            }
          </igo-panel>
        }
      </div>
    </igo-flexible>
  </div>
</mat-sidenav>
