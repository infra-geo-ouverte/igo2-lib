@if (
  ready &&
  feature &&
  isObject(feature.properties) &&
  feature.properties.target !== 'iframe'
) {
  <table class="igo-striped">
    <tbody>
      @for (
        property of filterFeatureProperties(feature) | keyvalue;
        track property
      ) {
        <tr>
          @if (
            feature.properties.target === '_blank' && property.key === 'url'
          ) {
            <td>
              <mat-icon matListItemIcon>{{ icon }}</mat-icon>
            </td>
          }
          @if (
            feature.properties.target === '_blank' && property.key === 'url'
          ) {
            <td>
              <a
                href="{{ property.value }}"
                target="_blank"
                rel="noopener noreferrer"
              >
                {{ 'igo.geo.targetHtmlUrl' | translate }} {{ title }}</a
              >
              <button
                class="copyClipboard"
                mat-icon-button
                (click)="copyTextToClipboard(property.value)"
              >
                <mat-icon>content_copy</mat-icon>
              </button>
            </td>
          }
          @if (feature.properties.target === undefined) {
            <td id="keyValue">
              {{ property.key }}
            </td>
          }
          @if (
            feature.properties.target === undefined &&
            !isObject(property.value) &&
            !isUrl(property.value) &&
            !isEmbeddedLink(property.value)
          ) {
            <td [innerHTML]="property.value"></td>
          }
          @if (
            feature.properties.target === undefined &&
            isEmbeddedLink(property.value)
          ) {
            <td>
              <u
                [ngStyle]="{ cursor: 'pointer', color: 'blue' }"
                (click)="openSecureUrl(property.value)"
                >{{ getEmbeddedLinkText(property.value) }}</u
              >
            </td>
          }
          @if (
            feature.properties.target === undefined &&
            !isObject(property.value) &&
            (isDoc(property.value) || isUrl(property.value)) &&
            !isImg(property.value)
          ) {
            <td>
              <u
                [ngStyle]="{ cursor: 'pointer', color: 'blue' }"
                (click)="openSecureUrl(property.value)"
                >{{ 'igo.geo.targetHtmlUrl' | translate }}</u
              >
              <button
                class="copyClipboard"
                mat-icon-button
                (click)="copyTextToClipboard(property.value)"
              >
                <mat-icon>content_copy</mat-icon>
              </button>
            </td>
          }
          @if (
            feature.properties.target === undefined &&
            !isObject(property.value) &&
            isUrl(property.value) &&
            isImg(property.value)
          ) {
            <td>
              <a
                href="{{ property.value }}"
                target="_blank"
                (click)="openSecureUrl(property.value)"
                rel="noopener noreferrer"
              >
                <img
                  igoImageError
                  src="{{ property.value | secureImage | async }}"
                  width="225"
                  height="auto"
                />
              </a>
            </td>
          }
          @if (
            feature.properties.target === undefined && isObject(property.value)
          ) {
            <td [innerHTML]="property.value | json"></td>
          }
        </tr>
      }
    </tbody>
  </table>
}

@if (isHtmlDisplay()) {
  <iframe
    [srcdoc]="htmlSanitizer(feature.properties)"
    [src]="urlSanitizer(feature.properties.url)"
  ></iframe>
}
