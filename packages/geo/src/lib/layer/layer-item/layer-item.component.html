<mat-list-item>
  <mat-icon
    class="igo-chevron"
    mat-list-avatar
    igoCollapse
    [target]="legend"
    [collapsed]="!(showLegend$ | async)"
    (toggle)="toggleLegend($event)">
  </mat-icon>
  <h4 matLine [matTooltip]="layer.title" matTooltipShowDelay="500">{{layer.title}}</h4>

  <button
    mat-icon-button
    color="primary"
    collapsibleButton
    tooltip-position="below"
    matTooltipShowDelay="500"
    [matTooltip]="layer.visible ?
                  ('igo.geo.layer.hideLayer' | translate) :
                  ('igo.geo.layer.showLayer' | translate)"
    (click)="toggleVisibility()">
    <mat-icon
      [ngClass]="{disabled: !(inResolutionRange$ | async)}">
      <ng-container *ngIf="layer.visible">
        visibility
      </ng-container>
      <ng-container *ngIf="!layer.visible">
        visibility_off
      </ng-container>
    </mat-icon>
  </button>

  <button
    mat-icon-button
    color="primary"
    igoCollapse
    [target]="actions"
    [collapsed]="true">
    <mat-icon>more_horiz</mat-icon>
  </button>
</mat-list-item>

<div #actions class="igo-layer-actions-container">
  <div class="igo-col igo-col-100 igo-col-100-m">
    <mat-slider
      id="opacity-slider"
      thumbLabel
      tickInterval="5"
      step="5"
      [min]="0"
      [max]="100"
      [(ngModel)]="opacity"
      [matTooltip]="'igo.geo.layer.opacity' | translate"
      matTooltipShowDelay="500"
      tooltip-position="below">
    </mat-slider>
  </div>

  <div class="igo-col igo-col-100 igo-col-100-m">
    <div class="igo-layer-button-group">
      <button
        color="primary"
        mat-icon-button
        tooltip-position="below"
        matTooltipShowDelay="500"
        [matTooltip]="'igo.geo.layer.raiseLayer' | translate"
        [disabled]="!orderable"
        (click)="layer.map.raiseLayer(layer)">
        <mat-icon>arrow_upward</mat-icon>
      </button>

      <button
        mat-icon-button
        color="primary"
        tooltip-position="below"
        matTooltipShowDelay="500"
        [matTooltip]="'igo.geo.layer.lowerLayer' | translate"
        [disabled]="!orderable"
        (click)="layer.map.lowerLayer(layer)">
        <mat-icon>arrow_downward</mat-icon>
      </button>

      <button
        *ngIf="removable === true"
        mat-icon-button
        color="warn"
        tooltip-position="below"
        matTooltipShowDelay="500"
        [matTooltip]="'igo.geo.layer.removeLayer' | translate"
        (click)="layer.map.removeLayer(layer)">
        <mat-icon>delete</mat-icon>
      </button>
      <ng-content select="[igoLayerItemToolbar]"></ng-content>

    </div>
  </div>
</div>

<div #legend class="igo-layer-legend-container">
  <igo-layer-legend *ngIf="showLegend$ | async" [layer]="layer"></igo-layer-legend>
</div>
