import{Ra as E,Sa as G,sa as k,u as v}from"./chunk-XOFOAZN4.js";import{Ab as I,Db as S,Dc as B,Fb as m,Ra as T,Xb as P,_b as H,ac as a,bc as s,ea as C,eb as b,ee as V,fe as F,g as r,ib as p,ie as D,je as W,kb as O,le as z,na as _,ub as A,v as u,vb as M,vc as N,wa as f,wb as x,xa as g,xc as j}from"./chunk-J6VW2V73.js";var h=class{options;activeTool$=new r(void 0);toolbar$=new r([]);activeTool$$;activeToolHistory=[];previousToolName;currentToolName;store=new v([],{getKey:o=>o.name});get tools$(){return this.store.entities$}constructor(o={}){this.options=o,this.setToolbar(o.toolbar),this.initStore()}destroy(){this.activeTool$$.unsubscribe(),this.store.destroy()}getTool(o){return this.store.get(o)}getTools(){return this.store.all()}setTools(o){this.store.load(o)}getToolbar(){return this.toolbar$.getValue()}setToolbar(o){this.toolbar$.next(o||[])}activateTool(o,t={}){let e=this.getTool(o);e!==void 0&&this.store.state.update(e,{active:!0,options:t},!0)}activatePreviousTool(){if(this.activeToolHistory.length<=1){this.deactivateTool();return}let[o]=this.activeToolHistory.splice(-2,2);this.activateTool(o)}getCurrentPreviousToolName(){return[this.previousToolName,this.currentToolName]}deactivateTool(){this.clearActiveToolHistory(),this.store.state.updateAll({active:!1})}initStore(){this.store=new v([],{getKey:o=>o.name}),this.activeTool$$=this.store.stateView.firstBy$(o=>o.state.active===!0).subscribe(o=>{if(o===void 0){this.setActiveTool(void 0);return}let t=o.entity,e=Object.assign({},t.options||{},o.state.options||{});this.setActiveTool(Object.assign({},t,{options:e}))})}setActiveTool(o){this.activeTool$.next(o),o===void 0?this.clearActiveToolHistory():(this.activeToolHistory=this.activeToolHistory.filter(t=>t!==o.name).concat([o.name]),this.previousToolName=this.currentToolName,this.currentToolName=this.activeToolHistory[this.activeToolHistory.length-1])}clearActiveToolHistory(){this.activeToolHistory=[]}};var y=(()=>{class i{static tools={};toolbox=new h;static register(t){i.tools[t.name]=t}constructor(){this.toolbox.setTools(this.getTools())}getTool(t){return i.tools[t]}getTools(){return Object.values(i.tools)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=C({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function it(i){return o=>{y.register(Object.assign({},i,{component:o}))}}function K(i="300ms",o="ease-in-out"){return V("toolSlideInOut",[W("enter",D({transform:"translate3d(0, 0, 0)"})),z("void => enter",F(i+" "+o))])}var U=(i,o)=>({"igo-tool-container-with-toolbar":i,"igo-tool-container-with-animation":o});function q(i,o){if(i&1&&(x(0,"igo-actionbar",2),a(1,"async"),a(2,"async"),a(3,"async")),i&2){let t=m();p("store",t.actionStore)("withIcon",!0)("withTitle",s(1,6,t.toolbarWithTitle$))("withTooltip",s(2,8,t.toolbarWithTitle$)===!1)("scrollActive",s(3,10,t.toolbarWithTitle$))("horizontal",!1)}}function J(i,o){if(i&1){let t=I();A(0,"div",3),a(1,"async"),S("@toolSlideInOut.start",function(){f(t);let n=m();return g(n.onAnimationStart())})("@toolSlideInOut.done",function(){f(t);let n=m();return g(n.onAnimationComplete())}),x(2,"igo-dynamic-outlet",4),M()}if(i&2){let t=o.ngIf,e=m();p("ngClass",H(6,U,!e.actionStore.empty,e.animate))("@toolSlideInOut",s(1,4,e.animation$)),T(2),p("component",t.component)("inputs",e.getToolInputs(t))}}var Q=(()=>{class i{activeTool$=new r(void 0);get isActive(){return!!this.activeTool$.value}actionStore=new E([]);animation$=new r("none");toolbar$=new r([]);toolbarWithTitle$=this.activeTool$.pipe(u(t=>t===void 0));activeTool$$;toolbar$$;animating$=new r(!1);animating$$;toolbox;animate=!1;color="white";get classColorGrey(){return this.color==="grey"}get classColorPrimary(){return this.color==="primary"}ngOnInit(){this.toolbar$$=this.toolbox.toolbar$.subscribe(t=>this.onToolbarChange(t)),this.activeTool$$=this.toolbox.activeTool$.subscribe(t=>this.onActiveToolChange(t))}ngOnDestroy(){this.toolbar$$.unsubscribe(),this.activeTool$$.unsubscribe(),this.actionStore.destroy()}onAnimationStart(){this.animating$.next(!0)}onAnimationComplete(){this.animating$.next(!1)}getToolInputs(t){return t.options||{}}onToolbarChange(t){this.setToolbar(t)}onActiveToolChange(t){if(!this.animate){this.setActiveTool(t);return}this.onAnimate(()=>this.setActiveTool(t))}setActiveTool(t){if(t===void 0)this.actionStore.state.updateAll({active:!1});else{let e=this.actionStore.get(t.name);e!==void 0&&this.actionStore.state.update(e,{active:!0},!0)}this.activeTool$.next(t),this.animate&&this.animation$.next("enter")}setToolbar(t){let e=t.reduce((n,R)=>{let l=this.toolbox.getTool(R);return l===void 0||n.push({id:l.name,title:l.title,icon:l.icon,tooltip:l.tooltip,args:[l,this.toolbox],handler:(d,c)=>{c.activateTool(d.name)},ngClass:d=>this.toolbox.activeTool$.pipe(u(c=>{let $=!1;c!==void 0&&d.name===c.name&&($=!0);let w=!1;return c!==void 0&&d.name===c.parent&&(w=!0),{"tool-activated":$,"children-tool-activated":w}}))}),n},[]);this.actionStore.load(e),this.toolbar$.next(t)}onAnimate(t){this.unAnimate(),this.animating$$=this.animating$.subscribe(e=>{e||(t.call(this),this.unAnimate())})}unAnimate(){this.animating$$&&this.animating$$.unsubscribe()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=_({type:i,selectors:[["igo-toolbox"]],hostVars:4,hostBindings:function(e,n){e&2&&O("color-grey",n.classColorGrey)("color-primary",n.classColorPrimary)},inputs:{toolbox:"toolbox",animate:"animate",color:"color"},standalone:!0,features:[P],decls:4,vars:6,consts:[[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal",4,"ngIf"],["class","igo-tool-container mat-body-1",3,"ngClass",4,"ngIf"],[3,"store","withIcon","withTitle","withTooltip","scrollActive","horizontal"],[1,"igo-tool-container","mat-body-1",3,"ngClass"],[3,"component","inputs"]],template:function(e,n){e&1&&(b(0,q,4,12,"igo-actionbar",0),a(1,"async"),b(2,J,3,9,"div",1),a(3,"async")),e&2&&(p("ngIf",s(1,2,n.toolbar$).length>0),T(2),p("ngIf",s(3,4,n.activeTool$)))},dependencies:[j,G,N,k,B],styles:[`[_nghost-%COMP%]{display:block;position:relative;overflow:hidden;width:100%;height:100%}[_nghost-%COMP%]     .mdc-list-item--with-leading-avatar .mdc-list-item__start{margin:0}[_nghost-%COMP%]   .igo-tool-container[_ngcontent-%COMP%]{position:absolute;inset:0;margin-bottom:0}[_nghost-%COMP%]   .igo-tool-container-with-animation[_ngcontent-%COMP%]{transform:translate3d(100%,0,0)}[_nghost-%COMP%]   .igo-tool-container-with-toolbar[_ngcontent-%COMP%]{left:50px}[_nghost-%COMP%]   igo-actionbar[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   igo-actionbar.with-title[_ngcontent-%COMP%]{width:100%;overflow:auto}[_nghost-%COMP%]   igo-actionbar[_ngcontent-%COMP%]:not(.with-title){width:48px;overflow:hidden;-moz-box-shadow:2px 0px 2px 0px #dddddd;-webkit-box-shadow:2px 0px 2px 0px #dddddd;-o-box-shadow:2px 0px 2px 0px #dddddd;box-shadow:2px 0 2px #ddd}@media only screen and (orientation:portrait) and (max-width: 599px),only screen and (orientation:landscape) and (max-width: 959px){[_nghost-%COMP%]   igo-actionbar[_ngcontent-%COMP%]:not(.with-title){overflow:auto}}[_nghost-%COMP%]   igo-dynamic-outlet[_ngcontent-%COMP%]{overflow:auto}
/*# sourceMappingURL=toolbox.component-FPMWIWHM.css.map */`],data:{animation:[K()]},changeDetection:0})}return i})();export{h as a,y as b,it as c,Q as d};
//# sourceMappingURL=chunk-F2YX6ECX.js.map
